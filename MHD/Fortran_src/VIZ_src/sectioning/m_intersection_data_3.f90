!
!     module m_intersection_data_3
!
      module m_intersection_data_3
!
!      Written by H. Matsui on june, 2006
!
      use m_precision
!
      implicit none
!
!
!   2 nodes which have differrent sign on a diagonal
!      (hexagonal...4 triangles)
!
!     flag = 1: c-c_ref >= 0
!     flag = 1: c-c_ref < 0
!
      integer(kind = kint), parameter, private :: nnod_tri = 3
      integer(kind = kint), parameter, private :: nnod_hex = 6
!
!
!       12345678: boundary...6 of 12: hexa; 
!           (3-2-1), (3-4-1), (1-4-5), (1-5-6)
! 129:  10000001: 1-2, 1-5, 8-5, 7-8, 4-8, 4-1: 1- 9-8-7-12-4;
!                 9- 8-1, 8-7-1, 1-7-12, 1-12-4
!  36:  00100100: 3-4, 3-7, 6-7, 5-6, 2-6, 2-3: 3-11-6-5-10-2;
!                 11-6-3, 6-5-3, 3-5-10, 3-10-2
!  18:  01001000: 2-3, 2-6, 5-6, 8-5, 1-5, 1-2: 2-10-5-8- 9-1;
!                 10-5-2, 5-8-2, 2-8- 9, 2- 9-1
!  72:  00010010: 4-1, 4-8, 7-8, 6-7, 3-7, 3-4: 4-12-7-6-11-3;
!                 12-7-4, 7-6-4, 4-6-11, 4-11-3
!   5:  10100000: 1-5, 4-1, 3-4, 3-7, 2-3, 1-2:  9-4-3-11-2-1;
!                 4-3- 9, 3-11- 9,  9-11-2,  9-2-1
! 160:  00000101: 2-6, 6-7, 7-8, 4-8, 8-5, 5-6: 10-6-7-12-8-5;
!                 6-7-10, 7-12-10, 10-12-8, 10-8-5
!  24:  00011000: 3-4, 4-1, 1-5, 5-6, 8-5, 4-8: 3-4- 9-5-8-12;
!                  4-9-3,  9-5-3, 3-5-8, 3-8-12
!  66:  01000010: 1-2, 2-3, 3-7, 7-8, 6-7, 2-6: 1-2-11-7-6-10;
!                 2-11-1, 11-7-1, 1-7-6, 1-6-10
!  33:  10000100: 4-1, 1-2, 2-6, 6-7, 5-6, 1-5: 4-1-10-6-5- 9;
!                 1-10-4, 10-6-4, 4-6-5, 4-5- 9
! 132:  00100001: 2-3, 3-4, 4-8, 8-5, 7-8, 3-7: 2-3-12-8-7-11;
!                 3-12-2, 12-8-2, 2-8-7, 2-7-11
!  10:  01010000: 2-6, 1-2, 4-1, 4-8, 3-4, 2-3: 10-1-4-12-3-2;
!                 1-4-10, 4-12-10, 10-12-3, 10-3-2
!  80:  00001010: 1-5, 5-6, 6-7, 3-7, 7-8, 8-5:  9-5-6-11-7-8;
!                 5-6- 9, 6-11- 9,  9-11-7,  9-7-8
!
!       12345678: boundary...6 of 12: hexa; 
!           (3-2-1), (3-4-1), (1-4-5), (1-5-6)
! 126:  01111110: 1-2, 4-1, 4-8, 7-8, 8-5, 1-5: 1-4-12-7-8- 9;
!                 4-12-1, 12-7-1, 1-7-8, 1-8- 9
! 219:  11011011: 3-4, 2-3, 2-6, 5-6, 6-7, 3-7: 3-2-10-5-6-11;
!                 2-10-3, 10-5-3, 3-5-6, 3-6-11
! 237:  10110111: 2-3, 1-2, 1-5, 8-5, 5-6, 2-6: 2-1- 9-8-5-10;
!                  1-9-2,  9-8-2, 2-8-5, 2-5-10
! 183:  11101101: 4-1, 3-4, 3-7, 6-7, 7-8, 4-8: 4-3-11-6-7-12;
!                  3-11-4, 11-6-4, 4-6-7, 4-7-12
! 250:  01011111: 1-5, 1-2, 2-3, 3-7, 3-4, 4-1:  9-1-2-11-3-4;
!                 1-2- 9, 2-11- 9,  9-11-3,  9-3-4
!  95:  11111010: 2-6, 5-6, 8-5, 4-8, 7-8, 6-7: 10-5-8-12-7-6;
!                 5-8-10, 8-12-10, 10-12-7, 10-7-6
! 231:  11100111: 3-4, 4-8, 8-5, 5-6, 1-5, 4-1: 3-12-8-5- 9-4;
!                 12-8-3, 8-5-3, 3-5- 9, 3- 9-4
! 189:  10111101: 1-2, 2-6, 6-7, 7-8, 3-7, 2-3: 1-10-6-7-11-2;
!                 10-6-1, 6-7-1, 1-7-11, 1-11-2
! 222:  01111011: 4-1, 1-5, 5-6, 6-7, 2-6, 1-2: 4- 9-5-6-10-1;
!                 9-5- 4, 5-6-4, 4-6-10, 4-10-1
! 123:  11011110: 2-3, 3-7, 7-8, 8-5, 4-8, 3-4: 2-11-7-8-12-3;
!                 11-7-2, 7-8-2, 2-8-12, 2-12-3
! 245:  10101111: 2-6, 2-3, 3-4, 4-8, 4-1, 1-2: 10-2-3-12-4-1;
!                 2-3-10, 3-12-10, 10-12-4, 10-4-1
! 175:  11110101: 1-5, 8-5, 7-8, 3-7, 6-7, 5-6:  9-8-7-11-6-5;
!                 8-7- 9, 7-11- 9,  9-11-6,  9-6-5
!
      integer(kind = kint), parameter :: nkind_etype_3 = 12
      integer(kind = kint), parameter :: num_hexa_3 =     1
      integer(kind = kint), parameter :: num_patch_3 =    4
      integer(kind = kint), parameter :: ih_2_p_3(12)                   &
     &     = (/3, 2, 1,   3, 4, 1,   1, 4, 5,   1, 5, 6/)
!
      integer(kind = kint) :: ihex_2_patches_3(3,2)
!
!
      integer(kind = kint), parameter                                   &
     &   :: iflag_psf_etype_3p(nkind_etype_3)                           &
     &     = (/129,  36,  18,  72,   5, 160,                            &
     &          24,  66,  33, 132,  10,  80/)
      integer(kind = kint), parameter                                   &
     &   :: iflag_psf_etype_3n(nkind_etype_3)                           &
     &     = (/126, 219, 237, 183, 250,  95,                            &
     &         231, 189, 222, 123, 245, 175/)
!
!
      integer(kind = kint), parameter                                   &
     &        :: iedge_hex_3p(nnod_hex,nkind_etype_3)                   &
     &      = reshape(                                                  &
     &       (/ 1,  9, 8,  7, 12, 4,    3, 11, 6,  5, 10, 2,            &
     &          2, 10, 5,  8,  9, 1,    4, 12, 7,  6, 11, 3,            &
     &          9,  4, 3, 11,  2, 1,   10,  6, 7, 12,  8, 5,            &
     &          3, 4,  9,  5, 8, 12,    1, 2, 11,  7, 6, 10,            &
     &          4, 1, 10,  6, 5,  9,    2, 3, 12,  8, 7, 11,            &
     &         10,  1, 4, 12,  3, 2,    9, 5,  6, 11, 7,  8 /),         &
     &       shape=(/nnod_hex,nkind_etype_3/) )
!
      integer(kind = kint)                                              &
     &        :: iedge_4_patch_3p(nnod_tri,num_patch_3,nkind_etype_3)   &
     &      = reshape(                                                  &
     &       (/ 9,  8,  1,    8,  7,  1,     1, 7, 12,    1, 12, 4,     &
     &          11, 6,  3,    6,  5,  3,     3, 5, 10,    3, 10, 2,     &
     &          10, 5,  2,    5,  8,  2,     2, 8,  9,    2,  9, 1,     &
     &          12, 7,  4,    7,  6,  4,     4, 6, 11,    4, 11, 3,     &
     &          4,  3,  9,    3, 11,  9,     9, 11, 2,    9,  2, 1,     &
     &          6,  7, 10,    7, 12, 10,    10, 12, 8,   10,  8, 5,     &
     &          4,  9,  3,    9,  5,  3,     3,  5, 8,    3, 8, 12,     &
     &          2, 11,  1,   11,  7,  1,     1,  7, 6,    1, 6, 10,     &
     &          1, 10,  4,   10,  6,  4,     4,  6, 5,    4, 5,  9,     &
     &          3, 12,  2,   12,  8,  2,     2,  8, 7,    2, 7, 11,     &
     &          1,  4, 10,    4, 12, 10,    10, 12, 3,   10, 3,  2,     &
     &          5,  6,  9,    6, 11,  9,     9, 11, 7,    9, 7,  8 /),  &
     &       shape=(/nnod_tri,num_patch_3,nkind_etype_3/) )
!
!
      integer(kind = kint), parameter                                   &
     &        :: iedge_hex_3n(nnod_hex,nkind_etype_3)                   &
     &      = reshape(                                                  &
     &       (/ 1, 4, 12,  7, 8,  9,    3, 2, 10,  5, 6, 11,            &
     &          2, 1,  9,  8, 5, 10,    4, 3, 11,  6, 7, 12,            &
     &          9, 1,  2, 11, 3,  4,   10, 5,  8, 12, 7,  6,            &
     &          3, 12, 8,  5,  9, 4,    1, 10, 6,  7, 11, 2,            &
     &          4,  9, 5,  6, 10, 1,    2, 11, 7,  8, 12, 3,            &
     &         10, 2,  3, 12, 4,  1,    9, 8,  7, 11,  6, 5 /),         &
     &       shape=(/nnod_hex,nkind_etype_3/) )
!
      integer(kind = kint)                                              &
     &        :: iedge_4_patch_3n(nnod_tri,num_patch_3,nkind_etype_3)   &
     &      = reshape(                                                  &
     &       (/ 4, 12,  1,   12,  7,  1,     1,  7, 8,    1, 8,  9,     &
     &          2, 10,  3,   10,  5,  3,     3,  5, 6,    3, 6, 11,     &
     &          1,  9,  2,    9,  8,  2,     2,  8, 5,    2, 5, 10,     &
     &          3, 11,  4,   11,  6,  4,     4,  6, 7,    4, 7, 12,     &
     &          1,  2,  9,    2, 11,  9,     9, 11, 3,    9, 3,  4,     &
     &          5,  8, 10,    8, 12, 10,    10, 12, 7,   10, 7,  6,     &
     &          12, 8,  3,    8,  5,  3,     3, 5,  9,    3,  9, 4,     &
     &          10, 6,  1,    6,  7,  1,     1, 7, 11,    1, 11, 2,     &
     &          9,  5,  4,    5,  6,  4,     4, 6, 10,    4, 10, 1,     &
     &          11, 7,  2,    7,  8,  2,     2, 8, 12,    2, 12, 3,     &
     &          2,  3, 10,    3, 12, 10,    10, 12, 4,   10,  4, 1,     &
     &          8,  7,  9,    7, 11,  9,     9, 11, 6,    9,  6, 5 /),  &
     &       shape=(/nnod_tri,num_patch_3,nkind_etype_3/) )
!
      end module m_intersection_data_3
