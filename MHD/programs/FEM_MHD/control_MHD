begin MHD_control
!!!!! Define for files !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!  num_subdomain_ctl: number of subdomains
!  num_smp_ctl:       number of smp processes
!
!  mesh_file_prefix:    prefix of mesh file (Default: in.domain#)
!
!  restart_file_prefix: prefix of restart file
!                            (Default: restart/rst.step#.domain#)
!
!  field_file_prefix:   prefix of snapshot field data
!                            (Default: out.step#.domain#.udt)
!
!    mesh_file_fmt_ctl:    data format for mesh file
!    restart_file_fmt_ctl: data format for restart files
!    field_file_fmt_ctl:   data format for field files
!                            (ascii or binary, Dafault is 'ascii')
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
  begin data_files_def
    debug_flag_ctl            'OFF'
!
    num_subdomain_ctl           2
    num_smp_ctl                 4
!
    mesh_file_prefix            'mesh/in'
!
    restart_file_prefix         'restart/rst'
    field_file_prefix           'field/out'
!
    mesh_file_fmt_ctl           'ascii'
    restart_file_fmt_ctl        'ascii'
    field_file_fmt_ctl          'ascii'
  end data_files_def
!
  begin org_data_files_def
    org_field_file_head_ctl     'field_org/out'
    org_field_file_fmt_ctl      'gzip'
  end org_data_files_def
!
  begin model
!!!!!  physical values!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! available valuables 
!   velocity, temperature, pressure, vorticity
!   vector_potential, magnetic_field, current_density, magnetic_potential
!   electric_field, poynting_flux
!   composition, perturbation_temp, parturbation_composition
!
!   filter_velo, filter_temp, filter_pert_temp
!   filter_vecp, filter_magne
!
!   kinetic_helicity, magnetic_helicity
!   current_helicity, cross_helicity
!
!   buoyancy_flux, Lorentz_work, mag_tension_work
!   magnetic_ene_generation, work_against_Lorentz
!   temp_generation, part_temp_gen
!   vis_ene_diffuse, mag_ene_diffuse
!   filtered_buoyancy_flux
!
!   thermal_diffusion, viscous_diffusion
!   diffuse_vector_p, magnetic_diffusion
!   magnetic_tension, Lorentz_force
!   Coriolis_force, buoyancy
!
!
!   heat_flux,      pert_heat_flux
!   composite_flux, pert_comp_flux
!   momentum_flux, maxwell_tensor
!   magnetic_induction, vecp_induction
!
!   heat_advect, pert_heat_advect
!   inertia,  
!   div_h_flux, div_part_h_flux
!   div_m_flux, div_maxwell_t
!
!   induction_tensor, div_induct_t
!
!   SGS_heat_flux
!   SGS_momentum_flux, SGS_maxwell_tensor
!   SGS_induct_tensor, SGS_vecp_induction
!
!   div_SGS_h_flux, div_SGS_m_flux
!   SGS_Lorentz
!   SGS_induction, 
!
!   SGS_Lorentz_work Reynolds_work
!   SGS_temp_flux_gen     SGS_mag_induction_flux
!
! termes for direct estimation
!   SGS_div_h_flux_true
!   SGS_div_m_flux_true, SGS_Lorentz_true, SGS_mag_induct_true
!
!   SGS_Lorentz_work_true   Reynolds_work_true
!   SGS_temp_gen_true       SGS_m_ene_gen_true
!   
!
!
!   v_r, v_theta, v_phi, v_s, w_r, w_theta, w_phi, w_s, 
!   a_r, a_theta, a_phi, a_s, b_r, b_theta, b_phi, b_s, 
!   j_r, j_theta, j_phi, j_s
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin phys_values_ctl
      array nod_value_ctl   12
        nod_value_ctl  velocity            Viz_On   Monitor_On
        nod_value_ctl  temperature         Viz_On   Monitor_On
        nod_value_ctl  pressure            Viz_On   Monitor_Off
        nod_value_ctl  vorticity           Viz_On   Monitor_Off
        nod_value_ctl  vector_potential    Viz_Off  Monitor_Off
        nod_value_ctl  magnetic_field      Viz_On   Monitor_On
        nod_value_ctl  current_density     Viz_On   Monitor_Off
        nod_value_ctl  magnetic_potential  Viz_Off  Monitor_Off
!        nod_value_ctl  composition         Viz_Off  Monitor_Off
!
        nod_value_ctl  heat_flux             Viz_Off  Monitor_Off
        nod_value_ctl  momentum_flux         Viz_Off  Monitor_Off
        nod_value_ctl  maxwell_tensor        Viz_Off  Monitor_Off
        nod_value_ctl  vecp_induction        Viz_Off  Monitor_Off
      end array nod_value_ctl
!
      array quad_field_name_ctl    5
        quad_field_name_ctl  vector_potential
        quad_field_name_ctl  heat_flux
        quad_field_name_ctl  momentum_flux
        quad_field_name_ctl  maxwell_tensor
        quad_field_name_ctl  vecp_induction
      end array quad_field_name_ctl
!
      array linear_field_name_ctl    7
        linear_field_name_ctl  velocity
        linear_field_name_ctl  pressure
        linear_field_name_ctl  vorticity
        linear_field_name_ctl  temperature
        linear_field_name_ctl  magnetic_field
        linear_field_name_ctl  current_density
        linear_field_name_ctl  magnetic_potential
!        linear_field_name_ctl  composition
      end array linear_field_name_ctl
    end phys_values_ctl
!
!!!!!  physical values for time evolution !!!!!!!!!!!!!!!!!!
! aviable valuables: velocity, temperature, magnetic_field
!                    vector_potential, composition
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin time_evolution_ctl
      array time_evo_ctl   4
        time_evo_ctl  temperature
        time_evo_ctl  velocity
        time_evo_ctl  vector_potential
        time_evo_ctl  composition
      end array time_evo_ctl
    end  time_evolution_ctl
!
!!!!!  setting for layers 
!
    begin layers_ctl
      array fluid_ele_grp    1
        fluid_ele_grp    outer_core
      end array fluid_ele_grp
!
      array conduct_ele_grp    1
!         conduct_ele_grp    inner_core
         conduct_ele_grp     outer_core
      end array conduct_ele_grp
    end  layers_ctl
!
!!!!!  setting for boundary condition
!
    begin bc_4_node
!!!!!  boundary condition for temperature  !!!!!!!!!!!!!!!!!!!!!!!!
!  available type:  fixed, file
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_temperature   2
        bc_temperature  fixed ICB  1.000
        bc_temperature  fixed CMB  0.000
      end array bc_temperature
!!!!!  boundary condition for velocity  !!!!!!!!!!!!!!!!!!!!!!!!
!  available type
!     fix_x,  fix_y,  fix_z
!     file_x, file_y, file_z
!     rot_x,  rot_y,  rot_z
!       (Note: set all compornents of the rotation vector!!)
!     free_slip_sph
!     specitial (you have to define the B.C. in source file)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_velocity  7
        bc_velocity  fix_x  ICB     0.000
        bc_velocity  fix_y  ICB     0.000
        bc_velocity  fix_z  ICB     0.000
        bc_velocity  fix_x  CMB     0.000
        bc_velocity  fix_y  CMB     0.000
        bc_velocity  fix_z  CMB     0.000
        bc_velocity  fix_z  equator 0.000
      end array bc_velocity
!!!!!  boundary condition for pressure  !!!!!!!!!!!!!!!!!!!!!!!!!!!
!  available type:  fixed, file
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_pressure  1
        bc_pressure  fixed Press  0.000
      end array bc_pressure
!!!!!  boundary condition for dummy scalar  !!!!!!!!!!!!!!!!!!!!!!!
!  available type:  fixed, file
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_composition  1
        bc_composition fixed  Press  0.000
      end array bc_composition
!!!!!  boundary condition for magnetic field  !!!!!!!!!!!!!!!!!!!!!
!  available type
!     fix_x,  fix_y,  fix_z
!     file_x, file_y, file_z
!     insulator (not recommend)
!     sph
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_magnetic_field   2
        bc_magnetic_field  fix_x  equator     0.000
        bc_magnetic_field  fix_y  equator     0.000
        bc_magnetic_field  fix_x  infinity     0.000
        bc_magnetic_field  fix_y  infinity     0.000
        bc_magnetic_field  fix_z  infinity     0.000
      end array bc_magnetic_field
!!!!!  boundary condition for magnetic potential  !!!!!!!!!!!!!!!!!
!  available type:  fixed, file, sph
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_electric_potential   3
        bc_electric_potential fixed   Centre  0.000
        bc_electric_potential fixed  infinity  0.000
        bc_electric_potential fixed  equator   0.000
      end array bc_electric_potential
!!!!!  boundary condition for vector potential  !!!!!!!!!!!!!!!!!!!
!  available type
!     fix_x,  fix_y,  fix_z
!     file_x, file_y, file_z
!     sph
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_vector_potential    6
        bc_vector_potential fix_x   infinity  0.000
        bc_vector_potential fix_y   infinity  0.000
        bc_vector_potential fix_z   infinity  0.000
        bc_vector_potential insulate_shell   ICB  0.000
        bc_vector_potential insulate_shell   CMB 0.000
        bc_vector_potential fix_z   equator   0.000
      end array bc_vector_potential
!!!!!  boundary condition for current density !!!!!!!!!!!!!!!!!!!!!
!  available type
!     fix_x,  fix_y,  fix_z
!     file_x, file_y, file_z
!     insulator (not recommend)
!     sph
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array bc_current   0
!        bc_current  fix_x  infinity     0.000
!        bc_current  fix_y  infinity     0.000
!        bc_current  fix_z  infinity     0.000
      end array bc_current
    end  bc_4_node
!
    begin bc_4_surface
!!!!!  boundary condition for heat flux  !!!!!!!!!!!!!!!!!!!!!!!!!!
!  available type:  fixed, file, SGS_commute
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array heat_flux_surf  0
!        heat_flux_surf  fixed       outer  0.000
!        heat_flux_surf  SGS_commute inner  0.000
!      end array heat_flux_surf
!!!!!  boundary condition for torque  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  available type
!     fix_x,  fix_y,  fix_z
!     file_x, file_y, file_z
!     normal_velocity
!     free_shell_in, free_shell_out
!     free_4_plane
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array velocity_surf     0 
!        velocity_surf  free_shell_in inner_surf   0.000
!        velocity_surf  free_shell_out  outer_surf   0.000
!      end array velocity_surf
!!!!!  boundary condition for pressure gradiend !!!!!!!!!!!!!!!!!!!
!  available type:  inner_shell, outer_shell
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       array pressure_surf  0 
!         pressure_surf   inner_shell inner_surf 0.000
!         pressure_surf   outer_shell outer_surf 0.000
!      end array pressure_surf
!!!!!  boundary condition for gradientof magnetic field  !!!!!!!!!!
!     fix_x,  fix_y,  fix_z
!     insulate_in, insulate_out (not recommended)
!     far_away                  (not used)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       array magnetic_field_surf  0
!          magnetic_field_surf  insulate_in  ICB_surf  0.000
!          magnetic_field_surf  insulate_out CMB_surf  0.000
!          magnetic_field_surf  far_away infinity_surf  0.000
!      end array magnetic_field_surf
!!!!!  boundary condition for gradientof magnetic field  !!!!!!!!!!
!     fix_x,  fix_y,  fix_z
!     insulate_in, insulate_out (not recommended)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       array vector_potential_surf  0
!          vector_potential_surf  insulate_out CMB_surf  0.000
!      end array vector_potential_surf
!!!!!  boundary condition for current density on surface  !!!!!!!!!!
!     fix_x,  fix_y,  fix_z
!     insulate_in,insulate_out (not recommended)
!     far_away                  (not used)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       array current_surf  0
!          current_surf  insulate_in  ICB_surf  0.000
!          current_surf  insulate_out CMB_surf  0.000
!          current_surf  far_away infinity_surf  0.000
!      end array current_surf
!!!!!  boundary condition for magnetic potential !!!!!!!!!!!!!!!!!
!  available type:  fixed (not used), file (not used)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       array electric_potential_surf  0
!          electric_potential_surf  insulate_in  ICB_surf  0.000
!          electric_potential_surf  insulate_out CMB_surf  0.000
!          electric_potential_surf  far_away infinity_surf  0.000
!      end array electric_potential_surf
!!!!!  boundary condition for dummy scalar !!!!!!!!!!!!!!!!!
!  available type:  fixed_grad (not used), file_grad (not used)
!                   fixed_field
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       array composition_flux_surf  0
!          composition_flux_surf  insulate_in  ICB_surf  0.000
!          composition_flux_surf  insulate_out CMB_surf  0.000
!          composition_flux_surf  far_away infinity_surf  0.000
!      end array composition_flux_surf
!!!!!  boundary condition for infinity (obsolute) !!!!!!!!!!!!!!!!!
!  available type:  fixed (not used), file (not used)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array infinity_surf 0
!        infinity_surf  fixed infinity_surf  0.000
!      end array infinity_surf
    end  bc_4_surface
!
!!!!!  define of forces !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  available forces
!     gravity, Coriolis, Lorentz, Composite_gravity, Filtered_gravity
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin forces_define
      array force_ctl      4
        force_ctl   gravity
        force_ctl   Coriolis
        force_ctl   Lorentz
        force_ctl   Composite_gravity
      end array force_ctl
    end  forces_define
!
!!!!!  dimensionless numbers !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  available numbers
!     Prandtl_number, magnetic_Prandtl_number
!     Rayleigh_number, modified_Rayleigh_number
!     Composit_Rayleigh_number
!     Reynords_number
!     Taylor_number, Ekman_number
!     Elsasser_number
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin dimensionless_ctl
      array dimless_ctl 6
        dimless_ctl  Prandtl_number                   1.0e-0
        dimless_ctl  modified_Rayleigh_number         1.0E+2
        dimless_ctl  Ekman_number                     1.0e-3
        dimless_ctl  magnetic_Prandtl_number          5.0e+0
        dimless_ctl  Composite_Rayleigh_number        1.0E+2
        dimless_ctl  Composite_Prandtl_number         1.0E+2
      end array dimless_ctl
    end  dimensionless_ctl
!
!!!!! Normalization settings  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!    define
!     coef_4_termal_ctl:      time integration and advection of temp
!     coef_4_velocity_ctl:    time integration and advection of temperature
!     coef_4_magnetic_ctl:    time integration and advection of magnetic f.
!     coef_4_composition_ctl: time integration and advection of composition
!
!     coef_4_press_ctl:   coefficients for pressure gradient
!     coef_4_mag_p_ctl:   coefficients for potential electric field
!
!     coef_4_t_diffuse_ctl:   coefficients for thermal diffusion
!     coef_4_v_diffuse_ctl:   coefficients for viscous diffusion
!     coef_4_m_diffuse_ctl:   coefficients for magnetic diffusion
!     coef_4_c_diffuse_ctl:   coefficients for compositional diffusion
!
!     coef_4_buoyancy_ctl:   coefficients for buoyancy
!     coef_4_Coriolis_ctl:   coefficients for Coriolis force
!     coef_4_Lorentz_ctl:    coefficients for Lorantz force
!     coef_4_composit_buoyancy_ctl: coefficients for compositional buoyancy
!
!     One:  1, Zero (Ignore), Two:  2,   Radial_parameter: (1-ri/ro)
!     Radial_35: (1-0.35)
!
!     Real number.... Power of each numbers
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
    begin coefficients_ctl
      begin thermal
        array coef_4_termal_ctl     1
          coef_4_termal_ctl            One                        1.0
        end array coef_4_termal_ctl
!
        array coef_4_t_diffuse_ctl  1
          coef_4_t_diffuse_ctl         Prandtl_number            -1.0
        end array coef_4_t_diffuse_ctl
      end  thermal
!
      begin momentum
        array coef_4_velocity_ctl            1
          coef_4_velocity_ctl          One                        1.0
        end array coef_4_velocity_ctl
!
        array coef_4_press_ctl               1
          coef_4_press_ctl             Ekman_number              -1.0
        end array coef_4_press_ctl
!
        array coef_4_v_diffuse_ctl           1
          coef_4_v_diffuse_ctl         One                        1.0
        end array coef_4_v_diffuse_ctl
!
        array coef_4_buoyancy_ctl            3
          coef_4_buoyancy_ctl          Radial_parameter           1.0
          coef_4_buoyancy_ctl          modified_Rayleigh_number   1.0
          coef_4_buoyancy_ctl          Ekman_number              -1.0
        end array coef_4_buoyancy_ctl
!
        array coef_4_Coriolis_ctl            2
          coef_4_Coriolis_ctl          Two                        1.0
          coef_4_Coriolis_ctl          Ekman_number              -1.0
        end array coef_4_Coriolis_ctl
!
        array coef_4_Lorentz_ctl             2
          coef_4_Lorentz_ctl           magnetic_Prandtl_number   -1.0
          coef_4_Lorentz_ctl           Ekman_number              -1.0
        end array coef_4_Lorentz_ctl
!
        array coef_4_composit_buoyancy_ctl   3
          coef_4_composit_buoyancy_ctl  Radial_parameter           1.0
          coef_4_composit_buoyancy_ctl  Composite_Rayleigh_number  1.0
          coef_4_composit_buoyancy_ctl  Ekman_number              -1.0
        end array coef_4_composit_buoyancy_ctl
      end  momentum
!
      begin induction
        array coef_4_magnetic_ctl   1
          coef_4_magnetic_ctl          One                        1.0
        end array coef_4_magnetic_ctl
!
        array coef_4_mag_p_ctl      1
          coef_4_mag_p_ctl             One                        1.0
        end array coef_4_mag_p_ctl
!
        array coef_4_m_diffuse_ctl  1
          coef_4_m_diffuse_ctl         magnetic_Prandtl_number   -1.0
        end array coef_4_m_diffuse_ctl
!
        array coef_4_induction_ctl  1
          coef_4_induction_ctl         One                       -1.0
        end array coef_4_induction_ctl
      end  induction
!
!
      begin composition
        array coef_4_composition_ctl     1
          coef_4_composition_ctl       One                        1.0
        end array coef_4_composition_ctl
!
        array coef_4_c_diffuse_ctl  1
          coef_4_c_diffuse_ctl         Composite_Prandtl_number  -1.0
        end array coef_4_c_diffuse_ctl
      end  composition
!
    end  coefficients_ctl
!
    begin gravity_define
!!!!! gravity_type !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      0: constant
!      1: constant_radial (constant intensity)
!      2: radial (propotional to radius)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      gravity_type_ctl     radial
!
!!!!! direction of gravity (opposite direction to that of buoyancy)
      array gravity_vec  3
        gravity_vec  x     0.000   end
        gravity_vec  y     0.000   end
        gravity_vec  z     -1.000   end
      end array gravity_vec
    end  gravity_define
!
    begin Coriolis_define
!!!!! direction of rotation vector for Coriolis force !!!!!!!!!!!!!
      array rotation_vec   3
        rotation_vec  x   0.000    end
        rotation_vec  y   0.000    end
        rotation_vec  z   1.000    end
      end array rotation_vec
      tri_sph_int_file     'rot_int.dat'
    end  Coriolis_define
!
    begin Magneto_convection_def
      magneto_cv_ctl    On
!!!!!!!!!  magnetoconvection model!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!    array ext_magne_vec:   0...off  more than 1...On
!     ext_magne_vec: external field (constant)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      array ext_magne_vec   3
        ext_magne_vec  x     0.000   end
        ext_magne_vec  y     0.000   end
        ext_magne_vec  z     1.000   end
      end array ext_magne_vec
    end  Magneto_convection_def
!
!!!!!!!!! model for stratification !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!    ref_temperature_ctl: none           (No reference of temperature)
!                         spherical_shell ( for spherical shell model)
!                         sph_constant_heat (for spherical shell model)
!                         linear_x        ( propotional to x-direction )
!                         linear_y        ( propotional to x-direction )
!                         linear_z        ( propotional to x-direction )
!
!
!    stratified_ctl:   0...off  1...on
!     stratified_sigma_ctl: intense ofstratification
!     stratified_width_ctl: width of stratification
!     stratified_outer_r_ctl: outer boundary of stratification
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin temperature_define
      ref_temp_ctl              spherical_shell
        begin low_temp_ctl
             depth         1.5384615384615384
             temperature   0.0d0
        end  low_temp_ctl
        begin high_temp_ctl
             depth         0.5384615384615384
             temperature   1.0d0
        end  high_temp_ctl
!
      stratified_ctl            Off
!      begin takepiro_model_ctl
!        stratified_sigma_ctl         0.000   end
!        stratified_width_ctl         0.000   end
!        stratified_outer_r_ctl       0.000   end
!      end takepiro_model_ctl
    end  temperature_define
!!!!!!!!!  SGS Model !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     SGS_model_ctl: gradient.........nonlinear gradient model
!                    similarity.......Similarity model
!                    dynamic..........Dynamic model
!                    dynamic_similarity..Dynamic similarity model
!     filtering_scheme_ctl:   line....filtering along each directrion
!                             3d......filtering using 3-dimensional table
!                             3d-smp..filtering using 3-dimensional on SMP model
!     difference_scheme_ctl:  original.....original spaatial difference
!                             modified_sgs.....modified differential for SGS terms
!                             modified_all.....modified differential for all differeciation
!     diff_coef_mode_ctl:     whole_domain.....lead one constant for whole domain
!                             layerd...........lead one constant for each layer
!     negative_clip_ctl:      none.............use negative model coefficient
!                             zero.............set model coefs to 0 if it is neagative
!                             keep.............keep previous coefs if it is neagative
!     direction_marging_ctl:  lsq........... ..taking LSQ over directions
!                             average..........average over directions
!                             weighting........weighting average by correlation
!     SGS_perturbation_ctl:   perturbation model for temperature and composition
!                             none...use temperature
!                             reference...use given reference temperature
!                             average.....use average of sphere or plane
!     model_coef_type_ctl:       Selection of model coefficient type
!                             field:      Intergrate model coefficients all directions
!                             components: Use model coefficients for each components
!     model_coef_coordinate_ctl: Selection of Cooredinate system for dynamic model
!                             Certecian:   use Certecian   coordinate
!                             Spherical:   use Spherical   coordinate
!                             Cylindrical: use Cylindrical coordinate
!
!
!
!
!    filter_file_prefix:  header name for filter data
!
!    3d_filtering_ctl
!      whole_area:   filtering groups for whole domain
!      fluid_area:   filtering groups for fluid region
!
!    filter_4_eqs_ctl:   filtering area for each equation
!                      (whole_filtering of fluid filtering)
!          momentum_filter_ctl:     momentum equation
!          heat_filter_ctl:         heat equation
!          induction_filter_ctl:    inducition equation
!
!    layering_data_ctl:  layering type for dynamic model
!                      start_end... indicate start and end element ID by group
!                      explicit...  set elements by element groups explicitly
!                      ele_group_list...  set elements by element group list
!    num_layer_grp_ctl:    num. of group for layering
!        grp_stack_each_layer_ctl:  end layer group for each coefs
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin SGS_control
      SGS_model_ctl           dynamic
      filtering_scheme_ctl    line
      diff_coef_mode_ctl      layerd
!
!      model_coef_type_ctl         field
      mom_flux_csim_type_ctl      field
      heat_flux_csim_type_ctl     components
      comp_flux_csim_type_ctl     components
      maxwell_csim_type_ctl       field
      uxb_csim_type_ctl           field
!
      model_coef_coordinate_ctl     cylindrical
      negative_clip_ctl             save
      clipping_limit_ctl            0.2
      direction_marging_ctl         lsq
!
      SGS_hf_factor_ctl        1.0
      SGS_cf_factor_ctl        1.0
      SGS_mf_factor_ctl        2.0
      SGS_mxwl_factor_ctl      1.0
      SGS_uxb_factor_ctl       1.5
!
      begin filter_files_def
        filter_elength_prefix   'filter_elen'
        filter_file_prefix      'filter_node'
        wider_filter_prefix     'filter/filter_coef_2'
!
        filter_elen_format        'ascii'
        filter_3d_format          'binary'
        filter_wide_format        'gzip'
!
        model_coef_rst_prefix       'model_coefs_ini'
        commutel_coef_rst_prefix    'commute_coefs_ini'
!        filter_file_prefix      'mesh/filter_node_l'
      end  filter_files_def
!
      min_step_dynamic_ctl      1
      max_step_dynamic_ctl      50
      delta_to_shrink_ctl      1.0d-2
      delta_to_extend_ctl      1.0d-3
!
      array SGS_terms_ctl      5
        SGS_terms_ctl    heat              end
        SGS_terms_ctl    inertia           end
        SGS_terms_ctl    gravity           end
        SGS_terms_ctl    Lorentz           end
        SGS_terms_ctl    induction         end
      end array SGS_terms_ctl
      SGS_perturbation_ctl    reference
!
      array commutation_ctl    9
        commutation_ctl    velocity          end
        commutation_ctl    vector_potential  end
        commutation_ctl    temperature       end
        commutation_ctl    dumnmy_scalar     end
!
        commutation_ctl    heat              end
        commutation_ctl    inertia           end
        commutation_ctl    Lorentz           end
        commutation_ctl    induction         end
        commutation_ctl    composit_flux     end
      end array commutation_ctl
!
      begin 3d_filtering_ctl
        array whole_filtering_grp_ctl  2
          whole_filtering_grp_ctl  Both   end
          whole_filtering_grp_ctl  whole  end
        end array 3d_filtering_ctl
!
        array fluid_filtering_grp_ctl  2
            fluid_filtering_grp_ctl  Both   end
            fluid_filtering_grp_ctl  fluid  end
        end array fluid_filtering_grp_ctl
!
        momentum_filter_ctl      fluid_filtering
        heat_filter_ctl          fluid_filtering
        induction_filter_ctl     whole_filtering
        composition_filter_ctl   fluid_filtering
      end 3d_filtering_ctl
!
      begin dynamic_model_layer_ctl
!
        layering_data_ctl     ele_group_list
        num_layering_grp_ctl      8
        start_layering_grp_name_ctl  fluid_layer_1
        num_fl_layer_grp_ctl      8
        start_fl_layer_grp_name_ctl  fluid_layer_1
!
        ngrp_SGS_on_sphere_ctl  21
      end dynamic_model_layer_ctl
!
!      begin dynamic_model_layer_ctl
!       layering_data_ctl     explicit
!       array layer_grp_name_ctl    8
!         layer_grp_name_ctl    fluid_layer_1   end
!         layer_grp_name_ctl    fluid_layer_2   end
!         layer_grp_name_ctl    fluid_layer_3   end
!         layer_grp_name_ctl    fluid_layer_4   end
!         layer_grp_name_ctl    fluid_layer_5   end
!         layer_grp_name_ctl    fluid_layer_6   end
!         layer_grp_name_ctl    fluid_layer_7   end
!         layer_grp_name_ctl    fluid_layer_8   end
!       end array layer_grp_name_ctl
!       array grp_stack_each_layer_ctl    4
!         grp_stack_each_layer_ctl  2
!         grp_stack_each_layer_ctl  4
!         grp_stack_each_layer_ctl  6
!         grp_stack_each_layer_ctl  8
!       end array grp_stack_each_layer_ctl
!
!        layering_data_ctl     start_end
!      end dynamic_model_layer_ctl
!
!
    end SGS_control
  end model
!
!
!
  begin control
!!!!!  information for time integration
    begin time_step_ctl
      elapsed_time_ctl      42500.
      i_step_init_ctl       0
      i_step_number_ctl     2000
!
      i_step_check_ctl         40
      i_step_rst_ctl          800
      i_step_sectioning_ctl   400
      i_step_pvr_ctl          400
      i_step_LIC_ctl          400
      i_step_field_ctl        800
      i_step_monitor_ctl       40
      i_step_sgs_coefs_ctl   2000
      i_step_boundary_ctl      40
!
      dt_ctl              5.0e-5
      time_init_ctl       0.0e-8
    end time_step_ctl
!!!!!  number of points for FEM
    begin intg_point_num_ctl
       intg_point_poisson_ctl   2
       intg_point_t_evo_ctl     2
    end intg_point_num_ctl
!!!!!  control for initial and restart data  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      0: No initial values
!      1: Read restart data as initial values
!
!     -1: Initial values for dynamo benchmark Case 0
!     -2: Initial values for dynamo benchmark Case 1
!
!    -11: rotate around x-axis
!    -12: rotate around y-axis
!    -13: rotate around z-axis
!
!     20: Initial values for kinematic dynamo
!
!  <-100: Initial value for convection in rotating shell
!          int(num/100)... wave number in zonal direction
!  >1000: Initial value for MHD dynamo in rotating shell
!          int(num/100)... wave number of temperature in zonal direction
!          int(num/1000)... index j for spherical harmonics 
!                           by degree l and order m
!                                j = l*(l+1) + m
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    begin restart_file_ctl
       rst_ctl                -2
    end restart_file_ctl
!!!!!  parameter for solver 
!
!      method_ctl:     Method for CG solver
!          (CG, BiCGSTAB, GPBiCG, MGCG, GAUSS, JACOBI)
!      precond_ctl:    Preconditioning for CG solver
!          (DIAG, SSOR, ILU, Gauss, Jacobi)
!      itr_ctl:        Maximum iteration
!      eps_ctl:        Residual ratio
!      sigma_ctl:      Coefficient for for ILU
!      sigma_diag_ctl: Coeffisient for SSOR preconditioning
!
!!!!!!  setting for Ordering for SMP solver !!!!!!!!!!!!!!!!!!!!!
!
!    order_method:  method for ordering
!                  RCM_DJDS or MC_DJDS
!    min_color_ctl: minimum num. of color for multi color
!    mc_color_ctl:  color number for MC ordering
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!  setting for MGCG solver !!!!!!!!!!!!!!!!!!!!!
!
!   num_multigrid_level_ctl: multigrid level
!   num_MG_subdomain_ctl  : number of domains for each level
!   MG_mesh_header_ctl: mesh data for coarse mesh
!        (MG_mesh_header_ctl.domain#)
!
!   MG_coarse_2_fine_tbl_ctl: prolongation data
!        (MG_coarse_2_fine_tbl_ctl.domain#)
!   MG_fine_2_coarse_tbl_ctl: restriction table
!        (MG_fine_2_coarse_tbl_ctl.domain#)
!
!   MG_fine_2_coarse_ele_tbl_ctl: element restriction table
!        (MG_fine_2_coarse_ele_tbl_ctl.domain#)
!
!   MG_elem_header_ctl:  element mesh data header
!        (MG_elem_header_ctl.domain#)
!   MG_surf_header_ctl: surface mesh data header
!        (MG_surf_header_ctl.domain#)
!   MG_edge_header_ctl: edge mesh data header
!        (MG_edge_header_ctl.domain#)
!
!   MG_METHOD_ctl:     Method for Multigrid iteration
!          (CG, BiCGSTAB, GPBiCG, MGCG, GAUSS, JACOBI)
!      precond_ctl:    Preconditioning Multigrid iteration
!          (DIAG, SSOR, ILU, Gauss, Jacobi)
!    Aviable METHOD  (MG_METHOD_ctl, MG_PRECOND_ctl)
!        (CG, DIAG),  (CG, SSOR),  (GAUSS, GAUSS), (JACOBI, JACOBI)
!
!
!    maxiter_mid_ctl:     iteration count for mid level
!    maxiter_coarsest_ctl: iteration count for coarsest level
!    MG_residual_ctl:      residual level for Multigrid iteration
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
    begin solver_ctl
      itr_ctl              1000
      eps_ctl              1.0E-4
      sigma_ctl               1.0
      sigma_diag_ctl          1.0
      method_ctl              CG
      precond_ctl             SSOR
!
      begin DJDS_solver_ctl
        order_method     RCM_DJDS
        min_color_ctl    60
        mc_color_ctl     100
      end DJDS_solver_ctl
!
      begin MGCG_parameter_ctl
        MG_METHOD_ctl     CG
        MG_PRECOND_ctl    DIAG
!
        maxiter_mid_ctl          2
        maxiter_coarsest_ctl    30
        MG_residual_ctl         1.0e-20
!
        num_multigrid_level_ctl           2
!
        array num_MG_subdomain_ctl    2
          num_MG_subdomain_ctl           8
          num_MG_subdomain_ctl           2
        end array num_MG_subdomain_ctl
!
        array MG_mesh_header_ctl    2
          MG_mesh_header_ctl          'mesh_1st/in'
          MG_mesh_header_ctl          'mesh_2nd/in'
        end array MG_mesh_header_ctl
!
        array MG_elem_header_ctl    2
          MG_elem_header_ctl          'mesh_1st/in_element'
          MG_elem_header_ctl          'mesh_2nd/in_element'
        end array MG_elem_header_ctl
!
        array MG_surf_header_ctl    2
          MG_surf_header_ctl          'mesh_1st/in_surface'
          MG_surf_header_ctl          'mesh_2nd/in_surface'
        end array MG_surf_header_ctl
!
        array MG_edge_header_ctl    2
          MG_edge_header_ctl          'mesh_1st/in_edge'
          MG_edge_header_ctl          'mesh_2nd/in_edge'
        end array MG_edge_header_ctl
!
!
        array MG_fine_2_coarse_tbl_ctl    2
          MG_fine_2_coarse_tbl_ctl          'mesh_1st/fine_2_coarse'
          MG_fine_2_coarse_tbl_ctl          'mesh_2nd/fine_2_coarse'
        end array MG_fine_2_coarse_tbl_ctl
!
        array MG_coarse_2_fine_tbl_ctl    2
          MG_coarse_2_fine_tbl_ctl          'mesh_1st/coarse_2_fine'
          MG_coarse_2_fine_tbl_ctl          'mesh_2nd/coarse_2_fine'
        end array MG_coarse_2_fine_tbl_ctl
!
        array MG_fine_2_coarse_ele_tbl_ctl    2
          MG_fine_2_coarse_ele_tbl_ctl      'mesh_1st/fine_2_coarse_ele'
          MG_fine_2_coarse_ele_tbl_ctl      'mesh_2nd/fine_2_coarse_ele'
        end array MG_fine_2_coarse_ele_tbl_ctl
!
!
        array MG_mesh_file_fmt_ctl    2
          MG_mesh_file_fmt_ctl           'ascii'
          MG_mesh_file_fmt_ctl           'ascii'
        end array MG_mesh_file_fmt_ctl
!
        array MG_table_file_fmt_ctl    2
          MG_table_file_fmt_ctl           'ascii'
          MG_table_file_fmt_ctl           'ascii'
        end array MG_table_file_fmt_ctl
      end MGCG_parameter_ctl
    end solver_ctl
!!!!!!   method for time evolution  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!   iflag_supg_ctl:      0...no SUPG 1...SUPG
!   num_multi_pass_ctl:  iteration counts for multi pass
!   maxiter_ctl:         maximum iteration number for correction
!   eps_4_velo_ctl:      ||div v||_{n} / ||div v||_{n-1}
!   eps_4_magne_ctl:     ||div B||_{n} / ||div B||_{n-1}
!   scheme_ctl:          Scheme for time evolution
!                 explicit_Euler...explicit_Euler
!                 2nd_Adams_Bashforth...2nd_Adams_Bashforth
!                 Crank_Nicolson...Crank_Nicolson with 2nd_Adams_Bashforth
!                 Crank_Nicolson_consist...Crank_Nicolson
!                                         with consistent mass matrix
!   eps_crank_ctl:        
!   method_4_velo_ctl:    method for Crank Nicolson Scheme
!   precond_4_crank_ctl:  preconditioning method for Crank Nicolson Scheme
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
    begin time_loop_ctl
      iflag_supg_ctl             Off
      iflag_supg_v_ctl           Off
      iflag_supg_t_ctl           Off
      iflag_supg_b_ctl           Off
      iflag_supg_c_ctl           Off

      num_multi_pass_ctl       3
      maxiter_ctl              1
      eps_4_velo_ctl           5.0e-1
      eps_4_magne_ctl          5.0e-1
      scheme_ctl              Crank_Nicolson
      diffuse_correct_ctl     On
      coef_imp_v_ctl          5.0e-1
      coef_imp_t_ctl          5.0e-1
      coef_imp_b_ctl          5.0e-1
      coef_imp_c_ctl          5.0e-1
!
      eps_crank_ctl           1.0e-6
      eps_B_solver_ctl        1.0e-6
!
      method_4_velo_ctl      CG 
      precond_4_crank_ctl     SSOR   
    end  time_loop_ctl
  end  control
!
!!!!!   control for monitor nodal data
  begin monitor_data_ctl
    array monitor_grp_ctl   1
      monitor_grp_ctl     mid_equator   end
    end array
  end  monitor_data_ctl
!
  begin visual_control
    array cross_section_ctl  4
      file  cross_section_ctl   ctl_psf_cmb
      file  cross_section_ctl   ctl_psf_z0 
      file  cross_section_ctl   ctl_psf_z0.3
      file  cross_section_ctl   ctl_psf_z1.0
    end array cross_section_ctl
!
    array isosurface_ctl  1
       file  isosurface_ctl   ctl_iso_temp
    end array isosurface_ctl
!
    array  volume_rendering  0
  end  visual_control
!
end MHD_control
